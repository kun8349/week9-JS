{"version":3,"sources":["admin.js"],"names":["orderData","dataAdmin","document","querySelector","init","renderOrderList","axios","get","api_path","headers","token","then","res","data","orders","str","forEach","item","productStr","products","title","quantity","status","paid","id","user","name","tel","address","email","createdAt","innerHTML","err","console","log","addEventListener","e","preventDefault","target","nodeName","statusId","getAttribute","orderStatus","newStatus","put"],"mappings":";;AAAA,IAAIA,SAAS,GAAG,EAAhB,C,CAEA;;AACA,IAAMC,SAAS,GAAGC,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAlB,C,CACA;AAIA;;AACA,SAASC,IAAT,GAAe;AACXC,EAAAA,eAAe;AAClB;;AACDD,IAAI,G,CAIJ;;AACA,SAASC,eAAT,GAA0B;AACtBC,EAAAA,KAAK,CAACC,GAAN,+DAAiEC,QAAjE,cAAmF;AAC/EC,IAAAA,OAAO,EAAC;AACJ,uBAAgBC;AADZ;AADuE,GAAnF,EAKCC,IALD,CAKM,UAAAC,GAAG,EAAE;AACPZ,IAAAA,SAAS,GAACY,GAAG,CAACC,IAAJ,CAASC,MAAnB;AACA,QAAIC,GAAG,GAAG,EAAV;AACAf,IAAAA,SAAS,CAACgB,OAAV,CAAkB,UAAAC,IAAI,EAAI;AACtB;AACA,UAAIC,UAAU,GAAG,EAAjB;AACAD,MAAAA,IAAI,CAACE,QAAL,CAAcH,OAAd,CAAsB,UAAAC,IAAI,EAAE;AACxBC,QAAAA,UAAU,iBAAUD,IAAI,CAACG,KAAf,eAAyBH,IAAI,CAACI,QAA9B,SAAV;AACH,OAFD;AAGA,UAAIC,MAAM,GAAG,EAAb;;AACA,UAAGL,IAAI,CAACM,IAAL,KAAc,KAAjB,EAAuB;AACnBD,QAAAA,MAAM,GAAG,KAAT;AACH,OAFD,MAEM,IAAGL,IAAI,CAACM,IAAL,KAAc,IAAjB,EAAsB;AACxBD,QAAAA,MAAM,GAAG,KAAT;AACH,OAXqB,CAYtB;;;AACAP,MAAAA,GAAG,wCACOE,IAAI,CAACO,EADZ,iEAGUP,IAAI,CAACQ,IAAL,CAAUC,IAHpB,0CAIUT,IAAI,CAACQ,IAAL,CAAUE,GAJpB,8DAMOV,IAAI,CAACQ,IAAL,CAAUG,OANjB,wCAOOX,IAAI,CAACQ,IAAL,CAAUI,KAPjB,8EASMX,UATN,0DAWOD,IAAI,CAACa,SAXZ,qHAagCb,IAAI,CAACM,IAbrC,wBAauDN,IAAI,CAACO,EAb5D,eAamEF,MAbnE,wKAgB2EL,IAAI,CAACO,EAhBhF,iDAAH;AAmBH,KAhCD;AAiCAvB,IAAAA,SAAS,CAAC8B,SAAV,GAAoBhB,GAApB;AAEH,GA3CD,WA4CO,UAAAiB,GAAG,EAAE;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GA9CD;AAgDH,C,CAED;;;AACA/B,SAAS,CAACkC,gBAAV,CAA2B,OAA3B,EAAmC,UAAAC,CAAC,EAAE;AAClCA,EAAAA,CAAC,CAACC,cAAF;;AACA,MAAGD,CAAC,CAACE,MAAF,CAASC,QAAT,IAAqB,IAArB,IAA6BH,CAAC,CAACE,MAAF,CAASC,QAAT,IAAqB,GAArD,EAAyD;AAAC;AAAO,GAF/B,CAGlC;;;AACA,MAAGH,CAAC,CAACE,MAAF,CAASC,QAAT,KAAsB,GAAzB,EAA6B;AACzB,QAAIC,QAAQ,GAAGJ,CAAC,CAACE,MAAF,CAASG,YAAT,CAAsB,SAAtB,CAAf;AACA,QAAInB,MAAM,GAAGc,CAAC,CAACE,MAAF,CAASG,YAAT,CAAsB,aAAtB,CAAb;AAEAC,IAAAA,WAAW,CAACF,QAAD,EAAUlB,MAAV,CAAX;AACAW,IAAAA,OAAO,CAACC,GAAR,CAAYZ,MAAZ;AACH,GAViC,CAWlC;;AAKH,CAhBD,E,CAkBA;;AACA,SAASoB,WAAT,CAAqBlB,EAArB,EAAwBF,MAAxB,EAA+B;AAC3B,MAAIqB,SAAJ;;AACA,MAAGrB,MAAM,KAAK,IAAd,EAAmB;AACfqB,IAAAA,SAAS,GAAG,KAAZ;AACH,GAFD,MAEM,IAAGrB,MAAM,KAAK,KAAd,EAAoB;AACtBqB,IAAAA,SAAS,GAAG,IAAZ;AACH;;AACDV,EAAAA,OAAO,CAACC,GAAR,CAAYS,SAAZ;AACArC,EAAAA,KAAK,CAACsC,GAAN,+DAAiEpC,QAAjE,cAAmF;AAC/E,YAAQ;AACJ,YAAMgB,EADF;AAEJ,cAAQmB;AAFJ;AADuE,GAAnF,EAKM;AACFlC,IAAAA,OAAO,EAAC;AACJ,uBAAgBC;AADZ;AADN,GALN,EAUCC,IAVD,CAUM,UAAAC,GAAG,EAAE;AACPP,IAAAA,eAAe;AAClB,GAZD,WAaO,UAAA2B,GAAG,EAAE;AACRC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAfD;AAgBH,C,CAGD","sourcesContent":["let orderData = [];\r\n\r\n//DOM訂單資訊\r\nconst dataAdmin = document.querySelector('[data-admin]');\r\n//DOM訂單狀態\r\n\r\n\r\n\r\n//初始化網站\r\nfunction init(){\r\n    renderOrderList();\r\n}\r\ninit();\r\n\r\n\r\n\r\n//渲染訂單資訊\r\nfunction renderOrderList(){\r\n    axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,{\r\n        headers:{\r\n            'Authorization':token,\r\n        } \r\n    })\r\n    .then(res=>{\r\n        orderData=res.data.orders;\r\n        let str = '';\r\n        orderData.forEach(item => {\r\n            //組合產品字串\r\n            let productStr = '';\r\n            item.products.forEach(item=>{\r\n                productStr += `<p>${item.title} X${item.quantity}</p>`;\r\n            })\r\n            let status = '';\r\n            if(item.paid === false){\r\n                status = '未處理'\r\n            }else if(item.paid === true){\r\n                status = '已處理'\r\n            }\r\n            //渲染order list\r\n            str += `<tr>\r\n                <td>${item.id}</td>\r\n                <td>\r\n                    <p>${item.user.name}</p>\r\n                    <p>${item.user.tel}</p>\r\n                </td>\r\n                <td>${item.user.address}</td>\r\n                <td>${item.user.email}</td>\r\n                <td data-productHTML>\r\n                   ${productStr}\r\n                </td>\r\n                <td>${item.createdAt}</td>\r\n                <td class=\"orderStatus-admin\">\r\n                    <a href=\"#\" data-status='${item.paid}' data-id='${item.id}'>${status}</a>\r\n                </td>\r\n                <td>\r\n                    <input type=\"button\" class=\"delSingleOrder-Btn\" value=\"刪除\" data-id='${item.id}'>\r\n                </td>\r\n            </tr>`\r\n        });\r\n        dataAdmin.innerHTML=str;\r\n        \r\n    })\r\n    .catch(err=>{\r\n        console.log(err);\r\n    })\r\n       \r\n}\r\n\r\n//訂單狀態+單筆刪除\r\ndataAdmin.addEventListener('click',e=>{\r\n    e.preventDefault();\r\n    if(e.target.nodeName == 'TD' || e.target.nodeName == 'P'){return}\r\n    //訂單狀態\r\n    if(e.target.nodeName === 'A'){\r\n        let statusId = e.target.getAttribute('data-id');\r\n        let status = e.target.getAttribute('data-status');\r\n        \r\n        orderStatus(statusId,status)\r\n        console.log(status);\r\n    }\r\n    // console.log(e.target.getAttribute('data-id'));\r\n\r\n    \r\n    \r\n    \r\n})\r\n\r\n//修改狀態函式\r\nfunction orderStatus(id,status){\r\n    let newStatus;\r\n    if(status === true){\r\n        newStatus = false;\r\n    }else if(status === false){\r\n        newStatus = true;\r\n    }\r\n    console.log(newStatus);\r\n    axios.put(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,{\r\n        \"data\": {\r\n            \"id\": id,\r\n            \"paid\": newStatus\r\n          }\r\n        },{\r\n        headers:{\r\n            'Authorization':token,\r\n        } \r\n    })\r\n    .then(res=>{\r\n        renderOrderList();\r\n    })\r\n    .catch(err=>{\r\n        console.log(err);\r\n    })\r\n}\r\n\r\n\r\n//刪除單筆函式"],"file":"admin.js"}