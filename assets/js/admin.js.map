{"version":3,"sources":["admin.js"],"names":["orderData","dataAdmin","document","querySelector","init","renderOrderList","axios","get","api_path","headers","token","then","res","data","orders","str","forEach","item","productStr","products","title","quantity","status","paid","id","user","name","tel","address","email","createdAt","innerHTML","err","console","log","addEventListener","e","preventDefault","target","nodeName","statusId","getAttribute","statusOrder","orderStatus","deleteId","orderDelete","newStatus","put","alert"],"mappings":"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","sourcesContent":["let orderData = [];\r\n\r\n//DOM訂單資訊\r\nconst dataAdmin = document.querySelector('[data-admin]');\r\n//DOM訂單狀態\r\n\r\n\r\n\r\n//初始化網站\r\nfunction init(){\r\n    renderOrderList();\r\n}\r\ninit();\r\n\r\n\r\n\r\n//渲染訂單資訊\r\nfunction renderOrderList(){\r\n    axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,{\r\n        headers:{\r\n            'Authorization':token,\r\n        } \r\n    })\r\n    .then(res=>{\r\n        orderData=res.data.orders;\r\n        let str = '';\r\n        orderData.forEach(item => {\r\n            //組合產品字串\r\n            let productStr = '';\r\n            item.products.forEach(item=>{\r\n                productStr += `<p>${item.title} X${item.quantity}</p>`;\r\n            })\r\n            let status = '';\r\n            if(item.paid === false){\r\n                status = '未處理'\r\n            }else if(item.paid === true){\r\n                status = '已處理'\r\n            }\r\n            //渲染order list\r\n            str += `<tr>\r\n                <td>${item.id}</td>\r\n                <td>\r\n                    <p>${item.user.name}</p>\r\n                    <p>${item.user.tel}</p>\r\n                </td>\r\n                <td>${item.user.address}</td>\r\n                <td>${item.user.email}</td>\r\n                <td data-productHTML>\r\n                   ${productStr}\r\n                </td>\r\n                <td>${item.createdAt}</td>\r\n                <td class=\"orderStatus-admin\">\r\n                    <a href=\"#\" data-status='${item.paid}' data-id='${item.id}'>${status}</a>\r\n                </td>\r\n                <td>\r\n                    <input type=\"button\" class=\"delSingleOrder-Btn\" value=\"刪除\" data-id='${item.id}'>\r\n                </td>\r\n            </tr>`\r\n        });\r\n        dataAdmin.innerHTML=str;\r\n        \r\n    })\r\n    .catch(err=>{\r\n        console.log(err);\r\n    })\r\n       \r\n}\r\n\r\n//訂單狀態+單筆刪除\r\ndataAdmin.addEventListener('click',e=>{\r\n    e.preventDefault();\r\n    if(e.target.nodeName == 'TD' || e.target.nodeName == 'P'){return}\r\n    //訂單狀態\r\n    if(e.target.nodeName === 'A'){\r\n        let statusId = e.target.getAttribute('data-id');\r\n        \r\n        let statusOrder ;\r\n        if(e.target.getAttribute('data-status')==='false'){\r\n            statusOrder = false;\r\n        }else{\r\n            statusOrder = true;\r\n        }\r\n        orderStatus(statusId,statusOrder);\r\n        \r\n    }\r\n    //單筆刪除\r\n    if(e.target.nodeName === 'INPUT'){\r\n        let deleteId = e.target.getAttribute('data-id');\r\n        orderDelete(deleteId);\r\n    }\r\n})\r\n\r\n//修改狀態函式\r\nfunction orderStatus(id,status){\r\n    let newStatus;\r\n    if(status === false){\r\n        newStatus = true;\r\n    }else{\r\n        newStatus = false;\r\n    }\r\n\r\n    axios.put(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders`,{\r\n        \"data\": {\r\n            \"id\": id,\r\n            \"paid\": newStatus\r\n          }\r\n        },{\r\n        headers:{\r\n            'Authorization':token,\r\n        } \r\n    })\r\n    .then(res=>{\r\n        alert('訂單狀態修改成功')\r\n        renderOrderList();\r\n    })\r\n    .catch(err=>{\r\n        console.log(err);\r\n    })\r\n}\r\n\r\n\r\n//刪除單筆函式\r\nfunction orderDelete(id){\r\n    axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/admin/${api_path}/orders/${id}`,\r\n    {\r\n        headers:{\r\n            'Authorization':token,\r\n        } \r\n    })\r\n    .then(res=>{\r\n        alert('單筆刪除成功');\r\n        renderOrderList();\r\n    })\r\n    .catch(err=>{\r\n        console.log(err.data);\r\n    })\r\n}\r\n\r\n//全部刪除\r\n\r\n\r\n//優化\r\n//1.餅圖\r\n//2.小數點"],"file":"admin.js"}